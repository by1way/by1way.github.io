<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title> | By1way</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = 'https://hm.baidu.com/hm.js?' + '23548c5ffb96043176d784e058b0ea36';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();</script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">By1way</h1><a id="logo" href="/.">By1way</a><p class="description">用心记录每一份成长、每一滴收获、每一个新奇</p></div><div id="nav-menu"><a href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/mq/"><i class="fa fa-quora"> 消息队列</i></a><a href="/booklist/"><i class="fa fa-book"> 读书清单</i></a><a href="/emotion/"><i class="fa fa-heart"> 个人情感</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title"></h1><div class="post-content"><h3 id="MySQL知识体系梳理"><a href="#MySQL知识体系梳理" class="headerlink" title="MySQL知识体系梳理"></a>MySQL知识体系梳理</h3><p>写在前面的话：由于工作原因所以对于MySQL的使用总是那么随意，这也就导致MySQL对我总是那么充满着敌意，对于mysql的使用总那么的肤浅，以甚至于连MySQL漏洞升级都搞不定，这一点对于一个立志成为一名架构师的我来说无疑是非常打击的。所以我想系统的学习一下mysql的知识，目标不是说当一个数据库dba,但是要求对mysql的基础知识有一个系统的掌握，对，是掌握不是了解。好吧为了这次mysql知识体系的进阶之旅，我选择了mysql官网、《MySQL实战45讲》、《从零开始带你成为Mysql实战优化高手》以及gp学院的性能优化mysql系列。希望先从广度上给自己建立一个多渠道的知识来源地，吸各家之所长为我所用，检验自己学习成果的方式是通过博客公众号的输出，面试等。最起码在遇到mysql的问题时，自己有一个清晰且合理的思路来搞定它。<br>这几个学习mysql的系列课程里面丁奇的《mysql实战45》可以算得上是专家级的，做为一个标杆。</p>
<p>以下是对mysql知识体系知识点的梳理希望能有一个全面的掌握：</p>
<h4 id="mysql基础架构"><a href="#mysql基础架构" class="headerlink" title="mysql基础架构"></a>mysql基础架构</h4><p><img src="/mysql/index_files/1.png" alt="mysql基础架构"></p>
<h5 id="连接器"><a href="#连接器" class="headerlink" title="连接器"></a>连接器</h5><p>连接器负责跟客户端建立连接、获取权限、维持和管理连接。命令如下 ：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -h$ip -P$port -u$user -p</span><br></pre></td></tr></table></figure></p>
<p>客户端默认连接时间由参数wait_timeout控制，为8小时</p>
<h5 id="查询缓存"><a href="#查询缓存" class="headerlink" title="查询缓存"></a>查询缓存</h5><p>mysql在拿到一个sql之后会先到查询缓存中看看，之前是不是执行过这条语句。之前执行过的语句及其结果可能会以key-value对的形式，被直接缓存在内存中。key是sql，value是结果。如果查询sql刚好在缓存中，其对应的value则直接会返回给客户端。<br>当然，这种查询缓存的实现是需要进行维护的，而这种维护也是需要耗费很大的代价，所以可以按需进行使用，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">query_cache_type=demand #这样就不使用查询缓存了</span><br></pre></td></tr></table></figure></p>
<p>从现在的角度来看，这个查询缓存的功能设计的确是有点鸡肋了，所以8.0把该功能拿下也是在情理之中的，对不对。</p>
<h5 id="分析器"><a href="#分析器" class="headerlink" title="分析器"></a>分析器</h5><p>顺序：词法分析-&gt;语法分析-&gt;语义分析</p>
<h5 id="优化器"><a href="#优化器" class="headerlink" title="优化器"></a>优化器</h5><p>优化器:在一张表里面有多个索引的时候，决定使用哪个索引。或者使用关联查询时，决定各表的连接顺序。</p>
<h5 id="执行器"><a href="#执行器" class="headerlink" title="执行器"></a>执行器</h5><p>调用存储引擎对应接口，以以下sql为例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from T where ID=10；</span><br></pre></td></tr></table></figure></p>
<p>执行器会先判断一下当前用户对T表是否有执行权限，如果没有就会返回错误。以T表为例，假如该表不存在索引，简述执行器执行流程：从该表中读取第一行，然后判断 ID是否为10，如果不是则跳过，如果是就把这一条放到结果集中。然后再调用存储引擎的下一行，再重复进行判断，直到该表的最后一条为止。有索引也是一样的处理流程。</p>
<h4 id="mysql日志系统"><a href="#mysql日志系统" class="headerlink" title="mysql日志系统"></a>mysql日志系统</h4><h4 id="事务隔离级别与实现"><a href="#事务隔离级别与实现" class="headerlink" title="事务隔离级别与实现"></a>事务隔离级别与实现</h4><h4 id="mysql的索引"><a href="#mysql的索引" class="headerlink" title="mysql的索引"></a>mysql的索引</h4><h4 id="mysql的全局锁、表锁、行锁"><a href="#mysql的全局锁、表锁、行锁" class="headerlink" title="mysql的全局锁、表锁、行锁"></a>mysql的全局锁、表锁、行锁</h4><h4 id="InnoDB的事务和锁"><a href="#InnoDB的事务和锁" class="headerlink" title="InnoDB的事务和锁"></a>InnoDB的事务和锁</h4><h4 id="表锁、行锁和一致性读"><a href="#表锁、行锁和一致性读" class="headerlink" title="表锁、行锁和一致性读"></a>表锁、行锁和一致性读</h4><h4 id="间隙锁和next-key-lock"><a href="#间隙锁和next-key-lock" class="headerlink" title="间隙锁和next-key lock"></a>间隙锁和next-key lock</h4><h4 id="InnoDB的加锁规则"><a href="#InnoDB的加锁规则" class="headerlink" title="InnoDB的加锁规则"></a>InnoDB的加锁规则</h4><h4 id="获取表行数的方法"><a href="#获取表行数的方法" class="headerlink" title="获取表行数的方法"></a>获取表行数的方法</h4><h4 id="普通索引与唯一索引"><a href="#普通索引与唯一索引" class="headerlink" title="普通索引与唯一索引"></a>普通索引与唯一索引</h4><h4 id="如何选择索引"><a href="#如何选择索引" class="headerlink" title="如何选择索引"></a>如何选择索引</h4><h4 id="给字符串加索引"><a href="#给字符串加索引" class="headerlink" title="给字符串加索引"></a>给字符串加索引</h4><h4 id="InnoDB脏而的控制策略"><a href="#InnoDB脏而的控制策略" class="headerlink" title="InnoDB脏而的控制策略"></a>InnoDB脏而的控制策略</h4><h4 id="日志和索引常见问题"><a href="#日志和索引常见问题" class="headerlink" title="日志和索引常见问题"></a>日志和索引常见问题</h4><h4 id="binlog和redo-log的写入机制"><a href="#binlog和redo-log的写入机制" class="headerlink" title="binlog和redo log的写入机制"></a>binlog和redo log的写入机制</h4><h4 id="大查询"><a href="#大查询" class="headerlink" title="大查询"></a>大查询</h4><h4 id="数据库表的空间回收"><a href="#数据库表的空间回收" class="headerlink" title="数据库表的空间回收"></a>数据库表的空间回收</h4><h4 id="表的复制"><a href="#表的复制" class="headerlink" title="表的复制"></a>表的复制</h4><h4 id="临时表排序的执行过程"><a href="#临时表排序的执行过程" class="headerlink" title="临时表排序的执行过程"></a>临时表排序的执行过程</h4><h4 id="binlog的格式和基本机制"><a href="#binlog的格式和基本机制" class="headerlink" title="binlog的格式和基本机制"></a>binlog的格式和基本机制</h4><h4 id="可靠性优先与可用性优先策略"><a href="#可靠性优先与可用性优先策略" class="headerlink" title="可靠性优先与可用性优先策略"></a>可靠性优先与可用性优先策略</h4><h4 id="多线程复制策略"><a href="#多线程复制策略" class="headerlink" title="多线程复制策略"></a>多线程复制策略</h4><h4 id="一主多从的主备切换流程"><a href="#一主多从的主备切换流程" class="headerlink" title="一主多从的主备切换流程"></a>一主多从的主备切换流程</h4><h4 id="读写分离"><a href="#读写分离" class="headerlink" title="读写分离"></a>读写分离</h4><h4 id="对索引字段的函数操作"><a href="#对索引字段的函数操作" class="headerlink" title="对索引字段的函数操作"></a>对索引字段的函数操作</h4><h4 id="提高性能的紧急手段"><a href="#提高性能的紧急手段" class="headerlink" title="提高性能的紧急手段"></a>提高性能的紧急手段</h4><h4 id="对mysql实例状态检测"><a href="#对mysql实例状态检测" class="headerlink" title="对mysql实例状态检测"></a>对mysql实例状态检测</h4><h4 id="误删数据"><a href="#误删数据" class="headerlink" title="误删数据"></a>误删数据</h4><h4 id="kill命令"><a href="#kill命令" class="headerlink" title="kill命令"></a>kill命令</h4><h4 id="join语句"><a href="#join语句" class="headerlink" title="join语句"></a>join语句</h4><h4 id="groupby算法"><a href="#groupby算法" class="headerlink" title="groupby算法"></a>groupby算法</h4><h4 id="insert语句"><a href="#insert语句" class="headerlink" title="insert语句"></a>insert语句</h4><h4 id="grant和flush-privileges语句"><a href="#grant和flush-privileges语句" class="headerlink" title="grant和flush privileges语句"></a>grant和flush privileges语句</h4><h4 id="临时表"><a href="#临时表" class="headerlink" title="临时表"></a>临时表</h4><h4 id="内存表的特性与适用场景"><a href="#内存表的特性与适用场景" class="headerlink" title="内存表的特性与适用场景"></a>内存表的特性与适用场景</h4><h4 id="分区表"><a href="#分区表" class="headerlink" title="分区表"></a>分区表</h4><h4 id="自增主键"><a href="#自增主键" class="headerlink" title="自增主键"></a>自增主键</h4><h4 id="orderby的算法流程"><a href="#orderby的算法流程" class="headerlink" title="orderby的算法流程"></a>orderby的算法流程</h4></div></div><div id="lv-container" data-id="city" data-uid="MTAyMC80MzczNi8yMDI3NQ=="><script>(function(d, s) {
   var j, e = d.getElementsByTagName(s)[0];
   if (typeof LivereTower === 'function') { return; }
   j = d.createElement(s);
   j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
   j.async = true;
   e.parentNode.insertBefore(j, e);
})(document, 'script');
</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/attendance/">attendance</a><span class="category-list-count">14</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/专业英语/">专业英语</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/分享/">分享</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/宝库/">宝库</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/文档服务器/">文档服务器</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/架构师训练营/">架构师训练营</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/读书/">读书</a><span class="category-list-count">2</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/ARTS/" style="font-size: 15px;">ARTS</a> <a href="/tags/Link/" style="font-size: 15px;">Link</a> <a href="/tags/资源/" style="font-size: 15px;">资源</a> <a href="/tags/阅读/" style="font-size: 15px;">阅读</a> <a href="/tags/分享/" style="font-size: 15px;">分享</a> <a href="/tags/Map/" style="font-size: 15px;">Map</a> <a href="/tags/Echarts/" style="font-size: 15px;">Echarts</a> <a href="/tags/FastDFS/" style="font-size: 15px;">FastDFS</a> <a href="/tags/分布式文档服务器/" style="font-size: 15px;">分布式文档服务器</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/09/15/readingmethod/">readingmethod</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/06/16/architect02/">第二周作业</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/12/17/ARTS-week21/">程序员的未来在哪儿</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/12/ARTS-week20/">计算机专用英语-DAY06</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/11/ARTS-week19/">计算机专用英语-DAY05</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/10/ARTS-week18/">计算机专用英语-DAY04</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/09/ARTS-week17/">计算机专用英语-DAY03</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/08/ARTS-week16/">计算机专用英语-DAY02</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/07/ARTS-week15/">计算机专用英语-DAY01</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/06/wechat/">分享一个公众号给你吧</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://wild2pro.com/" title="写程序的厨子" target="_blank">写程序的厨子</a><ul></ul><a href="https://lilyssh.cn/" title="lilyssh(新认识的一个技术牛人)" target="_blank">lilyssh(新认识的一个技术牛人)</a><ul></ul><a href="https://by1way.github.io/" title="我自己" target="_blank">我自己</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">By1way.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Carol.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>